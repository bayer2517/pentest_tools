#!/bin/bash

# Check if the correct number of arguments is provided
if [ $# -lt 2 ]; then
    echo "Usage: $0 <directory_path> <keyword1> <keyword2> ..."
    exit 1
fi

# Extract arguments
directory="$1"
shift  # Remove the first argument (directory path)
keywords=("$@")  # Store remaining arguments as an array

# Validate if the directory exists
if [ ! -d "$directory" ]; then
    echo "Error: Directory '$directory' does not exist."
    exit 1
fi

# Loop through each file in the directory
for file in "$directory"/*; do
    if [ -f "$file" ]; then
        # Perform the grep operation on the file for each keyword
        for keyword in "${keywords[@]}"; do
            result=$(grep -i "$keyword" "$file")

            # Print the filename and matching lines (colorized)
            if [ -n "$result" ]; then
                echo -e "\033[1;32m$file\033[0m:"
                # Highlight the keywords in the result
                highlighted_result=$(echo "$result" | grep -i --color=always "$keyword")
                echo -e "$highlighted_result\n"
            fi
        done
    fi
done
